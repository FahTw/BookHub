<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ชำระเงิน</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'orange': {
                            50: '#fff7ed',
                            100: '#ffedd5',
                            200: '#fed7aa',
                            300: '#fdba74',
                            400: '#fb923c',
                            500: '#f97316',
                            600: '#ea580c',
                            700: '#c2410c',
                            800: '#9a3412',
                            900: '#7c2d12'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .payment-method-card.active {
            border-color: #ea580c !important;
            background-color: #fff7ed;
        }
        
        .payment-section {
            transition: all 0.3s ease;
        }
        
        .payment-section.hidden {
            display: none;
        }
        
        #file-drop-zone.dragover {
            border-color: #fb923c;
            background-color: #fff7ed;
        }
        
        .animate-pulse {
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
    </style>
</head>

<body class="bg-gray-50">
    <header class="bg-white border-b border-gray-200 sticky top-0 z-10 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 py-4 lg:py-0 lg:h-16">
                <!-- Logo and Navigation -->
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-4 lg:gap-8">
                        <a href="/" class="text-2xl font-bold text-orange-600 hover:text-orange-700 transition-colors">BookHub</a>
                        <nav class="hidden sm:block">
                            <a href="#" class="text-gray-700 hover:text-gray-900 font-medium">หมวดหมู่หนังสือ</a>
                        </nav>
                    </div>
                </div>

                <!-- Search Bar -->
                <div class="flex-1 max-w-md lg:max-w-2xl lg:mx-8">
                    <div class="relative">
                        <input type="search" placeholder="ค้นหาหนังสือ..." class="w-full px-4 py-2 pl-12 border-2 border-gray-300 rounded-full focus:outline-none focus:border-orange-600 focus:ring-2 focus:ring-orange-100 transition-all" />
                        <svg class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                    </div>
                </div>

                <!-- User Actions -->
                <div class="flex items-center justify-end gap-4 lg:gap-6">
                    <a href="/cart" class="relative p-2 text-gray-700 hover:text-orange-600 transition-colors">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z" />
                        </svg>
                        <span class="absolute -top-1 -right-1 bg-orange-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">1</span>
                    </a>
                    <button class="p-2 text-gray-700 hover:text-orange-600 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 lg:py-12">
        <!-- Page Header -->
        <div class="mb-8">
            <h1 class="text-2xl lg:text-3xl font-bold text-gray-900 mb-2">ชำระเงิน</h1>
            <p class="text-gray-600">กรุณาชำระเงินเพื่อสั่งซื้อหนังสือ</p>
        </div>

        <div class="lg:grid lg:grid-cols-12 lg:gap-8">
            <!-- Payment Section -->
            <div class="lg:col-span-8">
                <div class="bg-white rounded-lg shadow-sm overflow-hidden">
                    <div class="px-6 py-4 bg-gray-50 border-b border-gray-200">
                        <h2 class="text-lg font-semibold text-gray-900">วิธีการชำระเงิน</h2>
                    </div>

                    <form id="paymentForm" method="post" enctype="multipart/form-data" class="p-6">
                        <!-- Payment Method Selection -->
                        <div class="mb-8">
                            <h3 class="text-lg font-semibold text-gray-900 mb-6">เลือกวิธีการชำระเงิน</h3>
                            <div class="grid md:grid-cols-3 gap-4">
                                <label class="payment-method-option cursor-pointer">
                                    <input type="radio" name="payment_method" value="promptpay" class="sr-only payment-method-radio" checked>
                                    <div class="border-2 border-gray-200 rounded-lg p-4 hover:border-orange-300 transition-colors payment-method-card active">
                                        <div class="flex items-center gap-3">
                                            <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                                                <svg class="w-6 h-6 text-orange-600" fill="currentColor" viewBox="0 0 24 24">
                                                    <path d="M3 3h6v6H3V3zm2 2v2h2V5H5zM3 15h6v6H3v-6zm2 2v2h2v-2H5zM15 3h6v6h-6V3zm2 2v2h2V5h-2z"/>
                                                </svg>
                                            </div>
                                            <div>
                                                <h4 class="font-medium text-gray-900">Promptpay</h4>
                                                <p class="text-sm text-gray-500">สแกน QR Code</p>
                                            </div>
                                        </div>
                                    </div>
                                </label>

                                <label class="payment-method-option cursor-pointer">
                                    <input type="radio" name="payment_method" value="bank_transfer" class="sr-only payment-method-radio">
                                    <div class="border-2 border-gray-200 rounded-lg p-4 hover:border-orange-300 transition-colors payment-method-card">
                                        <div class="flex items-center gap-3">
                                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                                <svg class="w-6 h-6 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                                                    <path d="M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm0 2h12v2H4V6zm0 4h12v4H4v-4z"/>
                                                </svg>
                                            </div>
                                            <div>
                                                <h4 class="font-medium text-gray-900">Mobile Banking</h4>
                                                <p class="text-sm text-gray-500">โอนเงินผ่านแอปธนาคาร</p>
                                            </div>
                                        </div>
                                    </div>
                                </label>

                                <label class="payment-method-option cursor-pointer">
                                    <input type="radio" name="payment_method" value="cash_on_delivery" class="sr-only payment-method-radio">
                                    <div class="border-2 border-gray-200 rounded-lg p-4 hover:border-orange-300 transition-colors payment-method-card">
                                        <div class="flex items-center gap-3">
                                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                                                <svg class="w-6 h-6 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                                                    <path d="M8 5a1 1 0 100 2h5.586l-1.293 1.293a1 1 0 101.414 1.414L16.414 7A1 1 0 0016 6V4a1 1 0 10-2 0v.586l-.293-.293A1 1 0 0012.293 5.5L14.586 8H9a1 1 0 000 2h5.586l-2.293 2.293a1 1 0 101.414 1.414L17.414 11A1 1 0 0018 10V8a1 1 0 10-2 0v.586l-.293-.293A1 1 0 0014.293 9.5L16.586 12H11a1 1 0 000 2h5.586l-1.293 1.293a1 1 0 101.414 1.414L19.414 13A1 1 0 0020 12V10a1 1 0 10-2 0v.586l-.293-.293A1 1 0 0016.293 11.5L18.586 14H13a1 1 0 100 2h1.586l-.293.293a1 1 0 101.414 1.414L17.414 16A1 1 0 0018 15V13a1 1 0 10-2 0v.586l-.293-.293A1 1 0 0014.293 14.5L16.586 17H3a1 1 0 100 2h11.586l-1.293 1.293a1 1 0 101.414 1.414L16.414 19A1 1 0 0016 18V16a1 1 0 10-2 0v.586l-.293-.293A1 1 0 0012.293 17.5L14.586 20H3a3 3 0 01-3-3V6a3 3 0 013-3h11a1 1 0 110 2H3a1 1 0 00-1 1v11a1 1 0 001 1z"/>
                                                </svg>
                                            </div>
                                            <div>
                                                <h4 class="font-medium text-gray-900">เก็บเงินปลายทาง</h4>
                                                <p class="text-sm text-gray-500">ชำระเงินเมื่อได้รับสินค้า</p>
                                            </div>
                                        </div>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- QR Code Section -->
                        <div id="qr-section" class="payment-section active mb-8">
                            <h3 class="text-xl font-bold text-center mb-4 text-gray-900">สแกน QR Code เพื่อชำระเงิน</h3>
                            <p class="text-gray-600 text-center mb-8">
                                ใช้กล้องมือถือหรือแอปสแกน QR Code<br>
                                เพื่อทำการชำระเงิน
                            </p>

                            <div class="flex justify-center mb-6">
                                <div class="bg-orange-100 p-8 rounded-2xl">
                                    <div class="bg-white p-6 rounded-xl shadow-lg">
                                        <div class="w-40 h-40 bg-gray-200 rounded-lg flex items-center justify-center">
                                            <svg class="w-20 h-20 text-gray-400" fill="currentColor" viewBox="0 0 24 24">
                                                <path d="M3 3h6v6H3V3zm2 2v2h2V5H5zM3 15h6v6H3v-6zm2 2v2h2v-2H5zM15 3h6v6h-6V3zm2 2v2h2V5h-2zM19 13h2v2h-2v-2zM13 15h2v2h-2v-2zM15 17h2v2h-2v-2zM17 15h2v2h-2v-2zM19 17h2v2h-2v-2zM21 19h2v2h-2v-2zM15 19h2v2h-2v-2zM13 13h2v2h-2v-2zM15 11h2v2h-2v-2zM13 17h2v2h-2v-2zM11 3h2v2h-2V3zM11 7h2v2h-2V7zM13 5h2v2h-2V5zM13 7h2v2h-2V7zM13 9h2v2h-2V9zM11 11h2v2h-2v-2zM11 13h2v2h-2v-2zM11 15h2v2h-2v-2zM11 17h2v2h-2v-2zM11 19h2v2h-2v-2zM11 21h2v2h-2v-2z" />
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="text-center">
                                <p class="text-gray-500 text-sm">จำนวนเงินที่ต้องชำระ: 
                                    <span class="font-semibold text-orange-600">฿127</span>
                                </p>
                            </div>
                        </div>

                        <!-- Bank Transfer Section -->
                        <div id="bank-transfer-section" class="payment-section hidden mb-8">
                            <h3 class="text-xl font-bold text-center mb-4 text-gray-900">ข้อมูลบัญชีสำหรับโอนเงิน</h3>
                            <div class="bg-gray-50 rounded-lg p-6 mb-6">
                                <div class="grid md:grid-cols-2 gap-6">
                                    <div>
                                        <h4 class="font-semibold text-gray-900 mb-2">ธนาคารกสิกรไทย</h4>
                                        <p class="text-gray-600">เลขบัญชี: <span class="font-mono">012-3-45678-9</span></p>
                                        <p class="text-gray-600">ชื่อบัญชี: บุ๊คฮับ จำกัด</p>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold text-gray-900 mb-2">ธนาคารไทยพาณิชย์</h4>
                                        <p class="text-gray-600">เลขบัญชี: <span class="font-mono">123-4-56789-0</span></p>
                                        <p class="text-gray-600">ชื่อบัญชี: บุ๊คฮับ จำกัด</p>
                                    </div>
                                </div>
                                <div class="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                                    <p class="text-sm text-yellow-800">
                                        <strong>หมายเหตุ:</strong> กรุณาโอนเงินตามจำนวนที่ระบุ และอัพโหลดสลิปการโอนด้านล่าง
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- File Upload Section -->
                        <div class="mb-8">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">อัพโหลดหลักฐานการชำระเงิน</h3>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-orange-400 transition-colors" id="file-drop-zone">
                                <input type="file" id="payment-proof" name="image" accept="image/*,.pdf" class="hidden" onchange="handleFileSelect(this)">
                                <div id="upload-placeholder">
                                    <svg class="w-12 h-12 mx-auto text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 48 48">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" />
                                    </svg>
                                    <h4 class="text-lg font-medium text-gray-900 mb-2">อัพโหลดสลิปการโอนเงิน</h4>
                                    <p class="text-gray-500 mb-4">ลากไฟล์มาวางที่นี่ หรือ</p>
                                    <button type="button" onclick="document.getElementById('payment-proof').click()" class="inline-flex items-center px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                                        </svg>
                                        เลือกไฟล์
                                    </button>
                                    <p class="text-xs text-gray-400 mt-2">รองรับ JPG, PNG, PDF (ขนาดไม่เกิน 5MB)</p>
                                </div>
                                
                                <!-- File Preview -->
                                <div id="file-preview" class="hidden">
                                    <div class="flex items-center justify-center gap-4">
                                        <div id="preview-content"></div>
                                        <div class="text-left">
                                            <p class="font-medium text-gray-900" id="file-name"></p>
                                            <p class="text-sm text-gray-500" id="file-size"></p>
                                            <button type="button" onclick="removeFile()" class="text-sm text-red-600 hover:text-red-800 mt-1">
                                                ลบไฟล์
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="upload-errors" class="hidden mt-2 p-3 bg-red-50 border border-red-200 rounded text-sm text-red-600"></div>
                        </div>

                        <!-- Submit Button -->
                        <div class="text-center">
                            <button type="submit" class="w-full md:w-auto px-8 py-3 bg-orange-600 text-white font-semibold rounded-lg hover:bg-orange-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" id="submit-payment" disabled>
                                <span class="inline-flex items-center">
                                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                    </svg>
                                    ยืนยันการชำระเงิน
                                </span>
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Back to Cart -->
                <div class="mt-6">
                    <a href="/cart" class="inline-flex items-center text-orange-600 hover:text-orange-700 font-medium">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                        </svg>
                        กลับไปที่ตะกร้าสินค้า
                    </a>
                </div>
            </div>

            <!-- Order Summary Section -->
            <div class="lg:col-span-4 mt-8 lg:mt-0">
                <div class="bg-white rounded-lg shadow-sm overflow-hidden sticky top-24">
                    <div class="px-6 py-4 bg-gray-50 border-b border-gray-200">
                        <h2 class="text-lg font-semibold text-gray-900">สรุปรายการสั่งซื้อ</h2>
                    </div>

                    <div class="p-6">
                        <!-- Order Items -->
                        <div class="space-y-4 mb-6">
                            <div class="flex items-center gap-4 pb-4 border-b border-gray-100">
                                <div class="w-16 h-20 bg-gray-200 rounded flex-shrink-0 overflow-hidden">
                                    <img src="/api/placeholder/64/80" alt="จิตวิทยาสายดาร์ก"
                                        class="w-full h-full object-cover" />
                                </div>
                                <div class="flex-1 min-w-0">
                                    <h3 class="font-semibold text-gray-900 mb-1 truncate">จิตวิทยาสายดาร์ก</h3>
                                    <p class="text-sm text-gray-500 mb-1">โดย Taneaw</p>
                                    <p class="text-sm text-gray-500">จำนวน: 1 เล่ม</p>
                                </div>
                                <div class="text-right">
                                    <span class="font-semibold text-gray-900">฿77</span>
                                </div>
                            </div>
                        </div>

                        <!-- Order Totals -->
                        <div class="space-y-3 mb-6">
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">ยอดรวมสินค้า</span>
                                <span class="text-gray-900">฿127</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">ค่าจัดส่ง</span>
                                <span class="text-green-600">ฟรี</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">ส่วนลด</span>
                                <span class="text-red-500">-฿50</span>
                            </div>
                            <div class="border-t border-gray-200 pt-3">
                                <div class="flex justify-between">
                                    <span class="font-semibold text-gray-900">ยอดรวมทั้งหมด</span>
                                    <span class="font-semibold text-lg text-orange-600">฿77</span>
                                </div>
                            </div>
                        </div>

                        <!-- Security Notice -->
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                            <div class="flex items-center">
                                <svg class="w-5 h-5 text-green-600 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 1L5 6v4c0 5.55 3.84 9.74 9 9.74s9-4.19 9-9.74V6l-5-5H10zm0 2.5L12.5 6v3.5c0 3.33-2.17 5.83-5 5.83s-5-2.5-5-5.83V6L5 3.5h5z" />
                                </svg>
                                <div>
                                    <p class="text-sm font-medium text-green-800">การชำระเงินปลอดภัย</p>
                                    <p class="text-xs text-green-600">ข้อมูลของคุณได้รับการคุ้มครอง</p>
                                </div>
                            </div>
                        </div>

                        <!-- Cancel Order -->
                        <button data-cancel-order class="w-full border border-gray-300 text-gray-700 hover:bg-gray-50 font-medium py-3 px-6 rounded-lg transition-colors mb-3">
                            ยกเลิกการสั่งซื้อ
                        </button>

                        <p class="text-xs text-gray-500 text-center">
                            หากมีปัญหาในการชำระเงิน กรุณาติดต่อ BookHub
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        let selectedFile = null;

        document.addEventListener('DOMContentLoaded', function () {
            // Payment method selection
            const paymentRadios = document.querySelectorAll('.payment-method-radio');
            const paymentSections = document.querySelectorAll('.payment-section');
            
            paymentRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    // Update card styling
                    document.querySelectorAll('.payment-method-card').forEach(card => {
                        card.classList.remove('active');
                        card.classList.remove('border-orange-500');
                        card.classList.add('border-gray-200');
                    });
                    
                    const selectedCard = this.closest('.payment-method-option').querySelector('.payment-method-card');
                    selectedCard.classList.add('active');
                    selectedCard.classList.remove('border-gray-200');
                    selectedCard.classList.add('border-orange-500');
                    
                    // Show/hide payment sections
                    paymentSections.forEach(section => {
                        section.classList.add('hidden');
                        section.classList.remove('active');
                    });
                    
                    if (this.value === 'qr_code') {
                        document.getElementById('qr-section').classList.remove('hidden');
                        document.getElementById('qr-section').classList.add('active');
                    } else if (this.value === 'bank_transfer') {
                        document.getElementById('bank-transfer-section').classList.remove('hidden');
                        document.getElementById('bank-transfer-section').classList.add('active');
                    }
                    
                    updateSubmitButton();
                });
            });

            // File drop zone
            const dropZone = document.getElementById('file-drop-zone');
            
            dropZone.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('border-orange-400', 'bg-orange-50');
            });
            
            dropZone.addEventListener('dragleave', function(e) {
                e.preventDefault();
                this.classList.remove('border-orange-400', 'bg-orange-50');
            });
            
            dropZone.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('border-orange-400', 'bg-orange-50');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFileSelect({ files: files });
                }
            });

            // Form submission
            document.getElementById('paymentForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                if (!selectedFile) {
                    showError('กรุณาอัพโหลดหลักฐานการชำระเงิน');
                    return;
                }
                
                // Simulate form submission
                const submitButton = document.getElementById('submit-payment');
                const originalText = submitButton.innerHTML;
                
                submitButton.disabled = true;
                submitButton.innerHTML = `
                    <span class="inline-flex items-center">
                        <svg class="animate-spin w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        กำลังประมวลผล...
                    </span>
                `;
                
                setTimeout(() => {
                    alert('ชำระเงินสำเร็จ! เราจะตรวจสอบการชำระเงินและยืนยันคำสั่งซื้อในไม่ช้า');
                    window.location.href = '/order-confirmation';
                }, 2000);
            });

            // Cancel order
            const cancelButton = document.querySelector('[data-cancel-order]');
            if (cancelButton) {
                cancelButton.addEventListener('click', function () {
                    if (confirm('คุณต้องการยกเลิกการสั่งซื้อนี้หรือไม่?')) {
                        window.location.href = '/cart';
                    }
                });
            }
        });

        function handleFileSelect(input) {
            const file = input.files[0];
            if (!file) return;
            
            // Validate file
            const maxSize = 5 * 1024 * 1024; // 5MB
            const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'application/pdf'];
            
            if (file.size > maxSize) {
                showError('ขนาดไฟล์ต้องไม่เกิน 5MB');
                return;
            }
            
            if (!allowedTypes.includes(file.type)) {
                showError('รองรับเฉพาะไฟล์ JPG, PNG, และ PDF เท่านั้น');
                return;
            }
            
            selectedFile = file;
            showFilePreview(file);
            hideError();
            updateSubmitButton();
        }

        function showFilePreview(file) {
            const placeholder = document.getElementById('upload-placeholder');
            const preview = document.getElementById('file-preview');
            const previewContent = document.getElementById('preview-content');
            const fileName = document.getElementById('file-name');
            const fileSize = document.getElementById('file-size');
            
            placeholder.classList.add('hidden');
            preview.classList.remove('hidden');
            
            fileName.textContent = file.name;
            fileSize.textContent = formatFileSize(file.size);
            
            if (file.type.startsWith('image/')) {
                const img = document.createElement('img');
                img.className = 'w-20 h-20 object-cover rounded-lg border';
                img.src = URL.createObjectURL(file);
                previewContent.innerHTML = '';
                previewContent.appendChild(img);
            } else {
                previewContent.innerHTML = `
                    <div class="w-20 h-20 bg-red-100 rounded-lg border flex items-center justify-center">
                        <svg class="w-8 h-8 text-red-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z" clip-rule="evenodd" />
                        </svg>
                    </div>
                `;
            }
        }

        function removeFile() {
            selectedFile = null;
            document.getElementById('payment-proof').value = '';
            document.getElementById('upload-placeholder').classList.remove('hidden');
            document.getElementById('file-preview').classList.add('hidden');
            hideError();
            updateSubmitButton();
        }

        function showError(message) {
            const errorDiv = document.getElementById('upload-errors');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
        }

        function hideError() {
            document.getElementById('upload-errors').classList.add('hidden');
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function updateSubmitButton() {
            const submitButton = document.getElementById('submit-payment');
            const hasFile = selectedFile !== null;
            const selectedMethod = document.querySelector('.payment-method-radio:checked');
            
            if (hasFile && selectedMethod) {
                submitButton.disabled = false;
                submitButton.classList.remove('opacity-50', 'cursor-not-allowed');
            } else {
                submitButton.disabled = true;
                submitButton.classList.add('opacity-50', 'cursor-not-allowed');
            }
        }
    </script>
</body>

</html>